import{u as c,a as u}from"./useMutation-Oh55HBpB.js";import{Y as i,a0 as d,Z as t,$ as n}from"./index-D-XR31JT.js";const p=e=>{switch(e.toLowerCase().trim()){case"draft":case"draf":return"draft";case"approved":case"disetujui":case"di setujui":return"approved";case"on going":case"ongoing":case"sedang berjalan":case"proses":case"processing":return"in_progress";case"done":case"selesai":return"done";default:return"draft"}},l=e=>{const s=p(e.status),a=e.status_badge?e.status_badge:s==="approved"?"success":s==="in_progress"?"warning":s==="done"?"primary":"secondary";return{id:e.id,noSpk:e.spk_no,buyer:e.buyer,spkDate:e.spk_date,deadline:e.deadline,status:s,status_label:e.status,status_badge:a,progress:e.progress||""}},k=()=>c({queryKey:["spkList"],queryFn:async()=>{const e=await n.get("/spk?start=0&length=100");if(e.data.success)return e.data.data.map(l);throw new Error("Failed to fetch SPK data")}}),S=()=>{const e=i();return u({mutationFn:async s=>{const a=await n.post("/spk",s);if(!a.data.success)throw new Error("Failed to add SPK");return a.data},onSuccess:()=>{e.invalidateQueries({queryKey:["spkList"]}),e.invalidateQueries({queryKey:["spkDetail"]}),t.success("SPK berhasil ditambahkan")},onError:s=>{var r;const a=s instanceof d?(r=s.response)==null?void 0:r.data.message:"Failed to add SPK";Array.isArray(a)?a.forEach(o=>t.error(o)):t.error(a)}})},f=()=>{const e=i();return u({mutationFn:async({id:s,data:a})=>{const r=await n.put(`/spk/${s}`,a);if(!r.data.success)throw new Error("Failed to update SPK");return r.data},onSuccess:(s,{id:a})=>{e.invalidateQueries({queryKey:["spkList"]}),e.invalidateQueries({queryKey:["spkDetail",a]}),t.success("SPK berhasil diperbarui")},onError:s=>{t.error(s instanceof Error?s.message:"Failed to update SPK")}})},K=()=>c({queryKey:["generateSpkNo"],queryFn:async()=>{const e=await n.get("/spk/generate-no");if(e.data.success)return e.data.data.spk_no;throw new Error("Failed to generate SPK number")}}),w=()=>{const e=i();return u({mutationFn:async s=>{const a=await n.put(`/spk/${s.id}/approval`,{status:s.status,user_id:s.user_id});if(!a.data.success)throw new Error("Failed to approve SPK");return a.data},onSuccess:(s,{id:a})=>{e.invalidateQueries({queryKey:["spkList"]}),e.invalidateQueries({queryKey:["spkDetail",a]}),t.success("SPK berhasil disetujui")},onError:s=>{var r;const a=s instanceof d?(r=s.response)==null?void 0:r.data.message:"Failed to approve SPK";Array.isArray(a)?a.forEach(o=>t.error(o)):t.error(a)}})};export{K as a,S as b,f as c,w as d,p as m,k as u};
