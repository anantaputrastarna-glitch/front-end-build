import{a0 as u,Z as F,X as A,_ as i,a3 as C,r as h,j as t,$ as b,k as q}from"./index-B3agpCGs.js";import{T}from"./TablesWidget13-CXq8lksz.js";import{D as I}from"./DynamicEditModal-DkKu4hPp.js";import{a as Q,D as K}from"./DynamicDeleteModal-DUoWsf9I.js";import{u as p}from"./useMutation-nrZU9vUa.js";import{f as x}from"./dateFormatter-Bb4_azhc.js";import"./ThemeProvider-DDvPy6_R.js";import"./Modal-BmgU_ZWM.js";import"./hasClass-m-K6Zulr.js";import"./warning-Abi01nQB.js";const P=async()=>(await u.get("/unit-of-measure?start=0&length=100")).data.data||[],B=async a=>(console.log("=== uom service ==="),(await u.post("/unit-of-measure",a)).data.data),L=async(a,o)=>(await u.put(`/unit-of-measure/${a}`,o)).data.data,$=async a=>{await u.delete(`/unit-of-measure/${a}`)},z=async a=>(await u.get(`/unit-of-measure/${a}`)).data.data,H=()=>{const a=F(),o=A({queryKey:["uoms"],queryFn:P}),r=p({mutationFn:B,onSuccess:e=>{console.log("Add uom success:",e),a.invalidateQueries({queryKey:["uoms"]}),i.success("UOM added successfully")},onError:e=>{console.error("Add uom error:",e),i.error(e instanceof Error?e.message:"Failed to add UOM")}}),m=p({mutationFn:({id:e,uom:c})=>L(e,c),onSuccess:e=>{console.log("Update uom success:",e),a.invalidateQueries({queryKey:["uoms"]}),i.success("UOM updated successfully")},onError:e=>{console.error("Update uom error:",e),i.error(e instanceof Error?e.message:"Failed to update UOM")}}),f=p({mutationFn:$,onSuccess:()=>{console.log("Delete uom success"),a.invalidateQueries({queryKey:["uoms"]}),i.success("UOM deleted successfully")},onError:e=>{console.error("Delete uom error:",e),i.error(e instanceof Error?e.message:"Failed to delete UOM")}}),y=p({mutationFn:z,onSuccess:e=>{console.log("Fetch uom by id success:",e)},onError:e=>{console.error("Fetch uom by id error:",e),i.error(e instanceof Error?e.message:"Failed to fetch UOM")}});return{uoms:o.data||[],isLoading:o.isLoading,error:o.error,addUom:r.mutate,updateUom:m.mutate,deleteUom:f.mutate,fetchUomById:y.mutate,isAdding:r.isPending,isUpdating:m.isPending,isDeleting:f.isPending}},R=[{title:"Dashboard",path:"/dashboard",isSeparator:!1,isActive:!1},{title:"Master UOM",path:"/master-uom",isSeparator:!0,isActive:!0}],te=()=>{const{currentUser:a}=C(),{uoms:o,isLoading:r,addUom:m,updateUom:f,deleteUom:y}=H(),[e,c]=h.useState(!1),[D,g]=h.useState(!1),[w,M]=h.useState(!1),[d,l]=h.useState(null),O=[{key:"name",label:"Nama",className:"min-w-150px"},{key:"created_by",label:"Dibuat Oleh",className:"min-w-120px"},{key:"created_dt",label:"Dibuat Tanggal",className:"min-w-140px"},{key:"changed_by",label:"Diubah Oleh",className:"min-w-120px"},{key:"changed_dt",label:"Diubah Tanggal",className:"min-w-140px"}],S=o.map(s=>({id:s.id,name:s.name,created_by:s.created_by,created_dt:x(s.created_dt),changed_by:s.changed_by||"-",changed_dt:s.changed_dt?x(s.changed_dt):"-"})),_=()=>{c(!0)},E=s=>{const n=(a==null?void 0:a.full_name)||"";m({name:s.name,user_id:n}),c(!1)},N=s=>{const n=o.find(U=>U.id===s.id);n&&(l(n),g(!0))},j=s=>{const n=(a==null?void 0:a.full_name)||"";d&&(f({id:d.id,uom:{name:s.name,user_id:n}}),g(!1),l(null))},k=s=>{const n=o.find(U=>U.id===s.id);n&&(l(n),M(!0))},v=()=>{d&&(y(d.id),M(!1),l(null))};return r?t.jsx(b,{children:t.jsxs("div",{className:"card-body text-center py-10",children:[t.jsx("div",{className:"spinner-border text-primary",role:"status",children:t.jsx("span",{className:"visually-hidden",children:"Loading..."})}),t.jsx("div",{className:"mt-3",children:"Memuat data UOM..."})]})}):t.jsxs("div",{className:"container-fluid",children:[t.jsx(q,{breadcrumbs:R,children:"Master UOM"}),t.jsx(b,{children:t.jsx(T,{className:"card-xl-stretch",rows:S,columns:O,labelAdd:"UOM",filters:[{key:"name",label:"Filter by Name"}],onDelete:k,onEdit:N,onAddClick:_})}),e&&t.jsx(Q,{show:e,title:"Tambah UOM",fields:[{name:"name",label:"Nama UOM",type:"text",required:!0,icon:"tag",placeholder:"Masukkan nama UOM"}],onSubmit:E,onClose:()=>c(!1)}),d&&t.jsx(I,{show:D,title:"Edit UOM",fields:[{name:"name",label:"Nama UOM",type:"text",required:!0,icon:"tag",placeholder:"Masukkan nama UOM"}],initialData:{name:d.name},onSave:j,onClose:()=>{g(!1),l(null)}}),d&&t.jsx(K,{show:w,title:"Hapus UOM",itemName:d.name,onConfirm:v,onClose:()=>{M(!1),l(null)}})]})};export{te as default};
