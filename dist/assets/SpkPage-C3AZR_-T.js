import{r as S,j as e,X as F,a0 as M,a2 as Q,$ as _,a4 as X,a3 as Z,a5 as B,Z as V,a1 as J,_ as A,g as ne,i as D,k as K,O as H,N as re}from"./index-_k8rBBZ3.js";import{T as de}from"./TablesWidget13-CaqZ-fwe.js";import{u as ie}from"./useVendors-C36TLsCC.js";import{a as ce,b as oe,u as xe,c as me,d as he,m as ue}from"./useSpkList-Ddhsu4Qx.js";import{M as w}from"./Modal-_M9WEbKH.js";import{F as t,C as j,B as q,D as je}from"./DynamicEditModal-DxuDKRd2.js";import{u as Y,b as pe,d as Ne,c as ee}from"./ThemeProvider-B59JBXsG.js";import{f as R}from"./dateFormatter-Bb4_azhc.js";import{S as ge}from"./StatusBadge-Dw0_kdg2.js";import{u as U}from"./useMutation-CCQ2BBFw.js";import"./hasClass-DpRZAxLp.js";import"./warning-Bmxm3qzx.js";const k=S.forwardRef(({bsPrefix:x,className:d,as:l="div",...c},a)=>{const m=Y(x,"row"),N=pe(),y=Ne(),g=`${m}-cols`,p=[];return N.forEach(v=>{const o=c[v];delete c[v];let s;o!=null&&typeof o=="object"?{cols:s}=o:s=o;const u=v!==y?`-${v}`:"";s!=null&&p.push(`${g}${u}-${s}`)}),e.jsx(l,{ref:a,...c,className:ee(d,m,...p)})});k.displayName="Row";const be=S.forwardRef(({bsPrefix:x,className:d,striped:l,bordered:c,borderless:a,hover:m,size:N,variant:y,responsive:g,...p},v)=>{const o=Y(x,"table"),s=ee(d,o,y&&`${o}-${y}`,N&&`${o}-${N}`,l&&`${o}-${typeof l=="string"?`striped-${l}`:"striped"}`,c&&`${o}-bordered`,a&&`${o}-borderless`,m&&`${o}-hover`),u=e.jsx("table",{...p,className:s,ref:v});if(g){let r=`${o}-responsive`;return typeof g=="string"&&(r=`${r}-${g}`),e.jsx("div",{className:r,children:u})}return u}),ye=({show:x,onHide:d})=>{const[l,c]=S.useState({no_spk:"",buyer:"",tanggal:new Date().toISOString().split("T")[0],deadline:"",status:"PENDING",notes:"",biayaJahit:"",user_id:"system"}),[a,m]=S.useState([{variantId:"",qty:""}]),{vendors:N}=ie(),{data:y}=F({queryKey:["productVariants"],queryFn:async()=>(await M.get("/product-variants")).data.data}),{data:g}=ce();S.useEffect(()=>{g&&!l.no_spk&&c(r=>({...r,no_spk:g}))},[g,l.no_spk]);const p=oe(),v=async()=>{if(!l.no_spk||!l.buyer||!l.tanggal||!l.deadline){alert("Please fill all required fields");return}if(a.some(r=>!r.variantId||!r.qty||parseInt(r.qty)<=0)){alert("Please select a product variant and enter a valid quantity for each article");return}await p.mutateAsync({no_spk:l.no_spk,buyer:l.buyer,spk_date:l.tanggal,deadline:l.deadline,status:l.status,notes:l.notes,sewing_cost:l.biayaJahit,user_id:l.user_id,details:a.map(r=>({product_variant_id:r.variantId,qty_order:r.qty}))}),d(),c({no_spk:"",buyer:"",tanggal:new Date().toISOString().split("T")[0],deadline:"",status:"PENDING",notes:"",biayaJahit:"",user_id:"system"}),m([{variantId:"",qty:""}])},o=()=>{m([...a,{variantId:"",qty:""}])},s=r=>{a.length>1&&m(a.filter((b,i)=>i!==r))},u=(r,b,i)=>{const h=[...a];h[r]={...h[r],[b]:i},m(h)};return e.jsxs(w,{show:x,onHide:d,size:"lg",children:[e.jsx(w.Header,{closeButton:!0,children:e.jsx(w.Title,{children:"Tambah SPK"})}),e.jsx(w.Body,{children:e.jsxs(t,{children:[e.jsxs(k,{children:[e.jsx(j,{md:6,children:e.jsxs(t.Group,{className:"mb-3",children:[e.jsx(t.Label,{children:"No SPK *"}),e.jsx(t.Control,{type:"text",value:l.no_spk,onChange:r=>c({...l,no_spk:r.target.value}),placeholder:"Masukkan nomor SPK",disabled:!0})]})}),e.jsx(j,{md:6,children:e.jsxs(t.Group,{className:"mb-3",children:[e.jsx(t.Label,{children:"Vendor *"}),e.jsxs(t.Select,{value:l.buyer,onChange:r=>c({...l,buyer:r.target.value}),children:[e.jsx("option",{value:"",children:"Pilih Vendor"}),N==null?void 0:N.map(r=>e.jsx("option",{value:r.name,children:r.name},r.id))]})]})})]}),e.jsxs(k,{children:[e.jsx(j,{md:6,children:e.jsxs(t.Group,{className:"mb-3",children:[e.jsx(t.Label,{children:"Tanggal *"}),e.jsx(t.Control,{type:"date",value:l.tanggal,onChange:r=>c({...l,tanggal:r.target.value})})]})}),e.jsx(j,{md:6,children:e.jsxs(t.Group,{className:"mb-3",children:[e.jsx(t.Label,{children:"Deadline *"}),e.jsx(t.Control,{type:"date",value:l.deadline,onChange:r=>c({...l,deadline:r.target.value})})]})})]}),e.jsxs(t.Group,{className:"mb-3",children:[e.jsx(t.Label,{children:"Notes"}),e.jsx(t.Control,{as:"textarea",rows:3,value:l.notes,onChange:r=>c({...l,notes:r.target.value}),placeholder:"Masukkan catatan"})]}),e.jsxs(t.Group,{className:"mb-3",children:[e.jsx(t.Label,{children:"Biaya Jahit"}),e.jsx(t.Control,{type:"number",value:l.biayaJahit,onChange:r=>c({...l,biayaJahit:r.target.value}),placeholder:"Masukkan biaya jahit"})]}),e.jsx("hr",{}),a.map((r,b)=>e.jsxs(k,{className:"mb-3 align-items-end",children:[e.jsx(j,{md:5,children:e.jsxs(t.Group,{children:[e.jsx(t.Label,{children:"Product Variant *"}),e.jsxs(t.Select,{value:r.variantId,onChange:i=>u(b,"variantId",i.target.value),children:[e.jsx("option",{value:"",children:"Pilih Variant"}),y==null?void 0:y.map(i=>e.jsxs("option",{value:i.id,children:[i.product_name," - ",i.color," - ",i.size]},i.id))]})]})}),e.jsx(j,{md:5,children:e.jsxs(t.Group,{children:[e.jsx(t.Label,{children:"Qty Order *"}),e.jsx(t.Control,{type:"number",value:r.qty,onChange:i=>u(b,"qty",i.target.value)})]})}),e.jsx(j,{md:2,children:e.jsx(q,{variant:"danger",onClick:()=>s(b),disabled:a.length===1,children:"Hapus"})})]},b)),e.jsx(q,{variant:"secondary",onClick:o,children:"Tambah Artikel"})]})}),e.jsxs(w.Footer,{children:[e.jsx(q,{variant:"secondary",onClick:d,children:"Batal"}),e.jsx(q,{variant:"primary",onClick:v,disabled:p.isPending,children:p.isPending?"Menyimpan...":"Simpan"})]})]})},ve=()=>{const x=Q(),{data:d,isLoading:l,error:c}=xe(),a=me(),[m,N]=S.useState(!1),[y,g]=S.useState(!1),[p,v]=S.useState(null),o=[{key:"noSpk",label:"No SPK",className:"min-w-150px"},{key:"buyer",label:"Vendor",className:"min-w-150px"},{key:"tanggal",label:"Tanggal",className:"min-w-100px"},{key:"deadline",label:"Deadline",className:"min-w-100px"},{key:"status",label:"Status",className:"min-w-100px"}],s=(d||[]).map(h=>({id:h.id,noSpk:h.noSpk,buyer:h.buyer,tanggal:R(h.spkDate),deadline:R(h.deadline),status:e.jsx("span",{className:`badge badge-light-${h.status_badge}`,children:h.status_label})})),u=()=>{N(!0)},r=h=>{const f=h.id;x(`/spk/detail/${f}`)},b=S.useCallback(h=>{const f=(d||[]).find(I=>I.id===h.id);f&&(v(f),g(!0))},[d]),i=S.useCallback(async h=>{if(p)try{await a.mutateAsync({id:p.id,data:h}),g(!1),v(null)}catch{alert("Error updating SPK")}},[p,a]);return l?e.jsx("div",{className:"container-fluid",children:e.jsx(_,{children:e.jsx("div",{className:"text-center p-5",children:"Loading SPK data..."})})}):c?e.jsx("div",{className:"container-fluid",children:e.jsx(_,{children:e.jsx("div",{className:"text-center p-5 text-danger",children:c.message})})}):e.jsxs("div",{className:"container-fluid",children:[e.jsx(_,{children:e.jsx(de,{className:"card-xl-stretch",rows:s,columns:o,labelAdd:"SPK",filters:[],onEdit:b,onAddClick:u,onRowClick:r})}),e.jsx(ye,{show:m,onHide:()=>N(!1)}),y&&p&&e.jsx(je,{show:y,title:"Edit SPK",fields:[{name:"no_spk",label:"No SPK",type:"text",required:!0,icon:"document"},{name:"buyer",label:"Vendor",type:"text",required:!0,icon:"user"},{name:"tanggal",label:"Tanggal",type:"date",required:!0,icon:"calendar"},{name:"deadline",label:"Deadline",type:"date",required:!0,icon:"time"},{name:"status",label:"Status",type:"select",options:[{value:"draft",label:"Draft"},{value:"approved",label:"Approved"},{value:"in_progress",label:"In Progress"},{value:"done",label:"Done"}],required:!0,icon:"note"},{name:"notes",label:"Notes",type:"textarea",required:!1,icon:"note"}],initialData:{no_spk:p.noSpk,buyer:p.buyer,spkDate:p.spkDate,status:p.status,deadline:p.deadline,notes:""},onSave:i,onClose:()=>{g(!1),v(null)}})]})},fe=({value:x})=>e.jsxs("div",{className:"d-flex flex-column w-100 me-2",children:[e.jsx("div",{className:"d-flex flex-stack mb-2",children:e.jsx("span",{className:"text-muted me-2 fs-7 fw-semibold",children:x})}),e.jsx("div",{className:"progress h-6px w-100",children:e.jsx("div",{className:"progress-bar bg-primary",role:"progressbar",style:{width:`${x}`}})})]}),se=x=>F({queryKey:["spkDetail",x],queryFn:async()=>{const d=await M.get(`/spk/${x}`);if(d.data.success)return d.data.data;throw new Error("Failed to fetch SPK detail")}}),Se=()=>{var o;const x=Q(),{id:d}=X(),[l,c]=S.useState(null),{data:a,isLoading:m,error:N}=se(d),y=he(),{currentUser:g}=Z();if(m)return e.jsx("div",{children:"Loading..."});if(N)return e.jsx("div",{children:"Error loading data"});if(!a)return e.jsx("div",{children:"No data found"});const p=a.details.map(s=>({id:s.id,produk:s.product_name,varian:`${s.color} - ${s.size}`,qtyOrder:s.qty_order,qtyDone:s.qty_done,qtyShipped:s.qty_shipped,reject:s.qty_reject,status_badge:s.status_badge,status:s.status,progress:s.progress,costPrice:s.cost_price})),v=a.boms.map(s=>({materialName:s.material_name,qty_required:s.qty_required,stock_qty:s.stock_qty,status_badge:s.status_badge,status:s.status,uom:s.unit_of_measure}));return e.jsxs("div",{className:"container-fluid",children:[e.jsxs(_,{className:"mb-5 shadow-sm border-0",children:[e.jsx("div",{className:"card-header border-0 py-4",children:e.jsxs("div",{className:"w-100 d-flex align-items-center justify-content-between",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"card-title mb-2 d-flex align-items-center",children:[e.jsx("i",{className:"bi bi-file-earmark-text-fill text-primary me-3 fs-1"}),a.spk_no]}),e.jsxs("p",{className:"text-muted mb-1 fs-5",children:[e.jsx("i",{className:"bi bi-building me-2"}),a.buyer]})]}),e.jsxs("div",{className:"text-end",children:[e.jsx("div",{className:"mb-3",children:e.jsxs("span",{className:"badge badge-light-primary fs-6 px-3 py-2",children:[e.jsx("i",{className:"bi bi-calendar-event me-1"}),"Deadline: ",R(a.deadline)]})}),e.jsx("span",{className:`badge badge-light-${a.status_badge} fs-7 fw-bold`,children:a.status})]})]})}),e.jsx("div",{className:"card-body pt-0",children:e.jsxs("div",{className:"row g-4",children:[e.jsx("div",{className:"col-md-2",children:e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx("i",{className:"bi bi-person-circle text-info me-3 fs-4"}),e.jsxs("div",{children:[e.jsx("span",{className:"fs-7 fw-bold text-gray-700 d-block",children:"Created By"}),e.jsx("p",{className:"text-gray-900 mb-0 fw-semibold",children:a.created_by}),e.jsx("small",{className:"text-muted",children:R(a.created_dt)})]})]})}),e.jsx("div",{className:"col-md-2",children:e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx("i",{className:"bi bi-check-circle text-success me-3 fs-4"}),e.jsxs("div",{children:[e.jsx("span",{className:"fs-7 fw-bold text-gray-700 d-block",children:"Approved By"}),e.jsx("p",{className:"text-gray-900 mb-0 fw-semibold",children:a.approved_by||"-"})]})]})}),e.jsx("div",{className:"col-md-2",children:e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx("i",{className:"bi bi-clock text-warning me-3 fs-4"}),e.jsxs("div",{children:[e.jsx("span",{className:"fs-7 fw-bold text-gray-700 d-block",children:"Approved At"}),e.jsx("p",{className:"text-gray-900 mb-0 fw-semibold",children:a.approved_dt?R(a.approved_dt):"-"})]})]})}),e.jsx("div",{className:"col-md-2",children:e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx("i",{className:"bi bi-cash text-primary me-3 fs-4"}),e.jsxs("div",{children:[e.jsx("span",{className:"fs-7 fw-bold text-gray-700 d-block",children:"Sewing Cost"}),e.jsxs("p",{className:"text-gray-900 mb-0 fw-semibold",children:["Rp. ",((o=a.sewing_cost)==null?void 0:o.toLocaleString("id-ID"))||"-"]})]})]})}),e.jsx("div",{className:"col-md-4",children:e.jsxs("div",{className:"d-flex align-items-center justify-content-between",children:[e.jsxs("div",{className:"flex-grow-1",children:[e.jsx("span",{className:"fs-7 fw-bold text-gray-700 d-block",children:"Notes"}),e.jsx("p",{className:"text-gray-900 mb-0 fw-semibold",children:a.notes})]}),e.jsx(B,{allowedRoles:["ADMIN","OWNER","PRODUKSI"],children:ue(a.status)==="draft"&&e.jsx("button",{className:"btn btn-primary btn-sm ms-3",onClick:()=>{g&&y.mutate({id:a.id,status:"APPROVE",user_id:g.full_name})},disabled:y.isPending,children:y.isPending?"Approving...":"Approve"})})]})})]})})]}),e.jsxs(_,{children:[e.jsx("div",{className:"p-5",children:e.jsxs("ul",{className:"nav nav-tabs nav-line-tabs",children:[e.jsx("li",{className:"nav-item",children:e.jsx("a",{className:"nav-link active","data-bs-toggle":"tab",href:"#tab1",children:"Artikel / Varian"})}),e.jsx("li",{className:"nav-item",children:e.jsx("a",{className:"nav-link","data-bs-toggle":"tab",href:"#tab2",children:"Bahan (BOM)"})}),e.jsx("li",{className:"nav-item",children:e.jsx("a",{className:"nav-link","data-bs-toggle":"tab",href:"#tab4",children:"History Surat Jalan"})})]})}),e.jsx("div",{className:"card-body",children:e.jsxs("div",{className:"tab-content",children:[e.jsx("div",{className:"tab-pane fade show active",id:"tab1",children:e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table table-striped align-middle gs-0 gy-5",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-0 min-w-150px",children:"Produk"}),e.jsx("th",{className:"p-0 min-w-150px",children:"Varian"}),e.jsx("th",{className:"p-0 min-w-100px",children:"Qty Order"}),e.jsx("th",{className:"p-0 min-w-100px",children:"Qty Done"}),e.jsx("th",{className:"p-0 min-w-100px",children:"Qty Shipped"}),e.jsx("th",{className:"p-0 min-w-100px",children:"Reject"}),e.jsx("th",{className:"p-0 min-w-100px",children:"Status"}),e.jsx("th",{className:"p-0 min-w-120px",children:"Progress"})]})}),e.jsx("tbody",{children:p.map((s,u)=>e.jsxs("tr",{onClick:()=>{c(s.id),x(`/spk/detail/${d}/stage/${s.id}`)},style:{cursor:"pointer"},className:l===s.id?"table-active":"",children:[e.jsx("td",{children:e.jsx("span",{className:"text-gray-900 fw-bold",children:s.produk})}),e.jsx("td",{children:e.jsx("span",{className:"text-gray-900",children:s.varian})}),e.jsx("td",{children:e.jsx("span",{className:"text-gray-900",children:s.qtyOrder})}),e.jsx("td",{children:e.jsx("span",{className:"text-gray-900",children:s.qtyDone})}),e.jsx("td",{children:e.jsx("span",{className:"text-gray-900",children:s.qtyShipped})}),e.jsx("td",{children:e.jsx("span",{className:"text-danger",children:s.reject})}),e.jsx("td",{children:e.jsx("span",{className:`badge badge-light-${s.status_badge==="WAITING_APPROVAL"?"warning":s.status_badge} fs-7 fw-bold`,children:s.status==="PROCESSING"?"Proses":s.status==="DONE"?"Selesai":s.status==="PENDING"?"Tertunda":s.status==="DONE_PARTIAL"?"Selesai (Partial)":s.status==="WAITING_APPROVAL"?"Menunggu Persetujuan":s.status})}),e.jsx("td",{children:e.jsx(fe,{value:s.progress})})]},u))})]})})}),e.jsx("div",{className:"tab-pane fade",id:"tab2",children:e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table align-middle gs-0 gy-5",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-0 min-w-200px",children:"Nama Material"}),e.jsx("th",{className:"p-0 min-w-100px",children:"Qty"}),e.jsx("th",{className:"p-0 min-w-100px",children:"Stock"}),e.jsx("th",{className:"p-0 min-w-80px",children:"Satuan Ukuran"}),e.jsx("th",{className:"p-0 min-w-100px",children:"Status"})]})}),e.jsx("tbody",{children:v.map((s,u)=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx("span",{className:"text-gray-900",children:s.materialName})}),e.jsx("td",{children:e.jsx("span",{className:"text-gray-900",children:s.qty_required})}),e.jsx("td",{children:e.jsx("span",{className:"text-gray-900",children:s.stock_qty})}),e.jsx("td",{children:e.jsx("span",{className:"text-gray-900",children:s.uom})}),e.jsx("td",{children:e.jsx("span",{className:`badge badge-light-${s.status_badge} fs-7 fw-bold`,children:s.status})})]},u))})]})})}),e.jsx("div",{className:"tab-pane fade",id:"tab4",children:e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table align-middle gs-0 gy-5",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-0 min-w-150px",children:"No Surat Jalan"}),e.jsx("th",{className:"p-0 min-w-150px",children:"Tanggal"}),e.jsx("th",{className:"p-0 min-w-100px",children:"Status"}),e.jsx("th",{className:"p-0 min-w-200px",children:"Catatan"})]})}),e.jsx("tbody",{children:a.surat_jalan_history&&a.surat_jalan_history.length>0?a.surat_jalan_history.map((s,u)=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx("span",{className:"text-gray-900",children:s.no||"-"})}),e.jsx("td",{children:e.jsx("span",{className:"text-gray-900",children:s.date?R(s.date):"-"})}),e.jsx("td",{children:e.jsx(ge,{status:s.status||"UNKNOWN"})}),e.jsx("td",{children:e.jsx("span",{className:"text-gray-900",children:s.notes||"-"})})]},u)):e.jsx("tr",{children:e.jsx("td",{colSpan:4,className:"text-center text-muted",children:"Tidak ada history surat jalan"})})})]})})})]})})]})]})},ke=x=>F({queryKey:["spkStages",x],queryFn:async()=>{const d=await M.get(`/spk-stage/spk-detail/${x}?start=0&length=100`);if(d.data.success)return d.data.data;throw new Error("Failed to fetch SPK stages")}}),we=()=>{const x=V();return U({mutationFn:async d=>{const l=await M.post("/spk-stage",d);if(l.data.success)return l.data.data;throw new Error("Failed to add SPK stage")},onSuccess:()=>{x.invalidateQueries({queryKey:["spkStages"]}),A.success("SPK stage added successfully")},onError:d=>{var c;const l=d instanceof J?(c=d.response)==null?void 0:c.data.message:d instanceof Error?d.message:"Failed to add SPK stage";Array.isArray(l)?l.forEach(a=>A.error(a)):A.error(l)}})},qe=()=>{const x=V();return U({mutationFn:async({id:d,payload:l})=>{const c=await M.put(`/spk-stage/${d}`,l);if(c.data.success)return c.data.data;throw new Error("Failed to update SPK stage")},onSuccess:()=>{x.invalidateQueries({queryKey:["spkStages"]}),A.success("SPK stage updated successfully")},onError:d=>{var c;const l=d instanceof J?(c=d.response)==null?void 0:c.data.message:d instanceof Error?d.message:"Failed to update SPK stage";Array.isArray(l)?l.forEach(a=>A.error(a)):A.error(l)}})},ae=x=>{const[d,l]=S.useState({stageName:"",seq:1,qtyIn:0,qtyMax:0,qtyReject:[{stageName:"Cutting",qty:""},{stageName:"Jahit",qty:""}],status:"PENDING",startAt:"",endAt:"",pic:[],...x}),c=S.useRef(void 0);return S.useEffect(()=>{const o=JSON.stringify(x);c.current!==o&&(l({stageName:"",seq:1,qtyIn:0,qtyMax:0,qtyReject:[],status:"PENDING",startAt:"",endAt:"",pic:[],...x}),c.current=o)},[x]),{formData:d,setFormData:l,handleFormChange:(o,s)=>{l(u=>({...u,[o]:s}))},handleNumericChange:(o,s)=>{if(s===""){l(r=>({...r,[o]:0}));return}const u=parseInt(s);!isNaN(u)&&u>=0&&l(r=>({...r,[o]:u}))},updateRejectEntry:(o,s,u)=>{l(r=>({...r,qtyReject:r.qtyReject.map((b,i)=>i===o?{...b,[s]:u}:b)}))},addPicEntry:()=>{l(o=>({...o,pic:[...o.pic,{name:"",qty:""}]}))},updatePicEntry:(o,s,u)=>{l(r=>({...r,pic:r.pic.map((b,i)=>i===o?{...b,[s]:u}:b)}))},removePicEntry:o=>{l(s=>({...s,pic:s.pic.filter((u,r)=>r!==o)}))},resetForm:o=>{l({stageName:"",seq:1,qtyIn:0,qtyMax:0,qtyReject:[{stageName:"Cutting",qty:""},{stageName:"Jahit",qty:""}],status:"PENDING",startAt:"",endAt:"",pic:[],...o})}}},_e=({show:x,onHide:d,onSubmit:l,nextSeq:c})=>{const{formData:a,handleFormChange:m,handleNumericChange:N,addPicEntry:y,updatePicEntry:g,removePicEntry:p,resetForm:v}=ae({seq:c}),o=()=>{l(a),v({seq:c}),d()};return e.jsxs(w,{show:x,onHide:d,size:"lg",children:[e.jsx(w.Header,{closeButton:!0,children:e.jsx(w.Title,{children:"Tambah Tahapan Produksi"})}),e.jsx(w.Body,{children:e.jsxs(t,{children:[e.jsxs(k,{className:"mb-3",children:[e.jsx(j,{md:8,children:e.jsxs(t.Group,{children:[e.jsx(t.Label,{children:"Nama Tahapan"}),e.jsx(t.Control,{type:"text",value:a.stageName,onChange:s=>m("stageName",s.target.value),placeholder:"Masukkan nama tahapan"})]})}),e.jsx(j,{md:4,children:e.jsxs(t.Group,{children:[e.jsx(t.Label,{children:"Tahap"}),e.jsx(t.Control,{type:"text",value:a.seq,onChange:s=>N("seq",s.target.value),min:"1",placeholder:"1"})]})})]}),e.jsx(k,{className:"mb-3",children:e.jsx(j,{md:12,children:e.jsxs(t.Group,{children:[e.jsx(t.Label,{children:"Qty In"}),e.jsx(t.Control,{type:"text",value:a.qtyIn,onChange:s=>N("qtyIn",s.target.value),min:"0"})]})})}),e.jsx(k,{className:"mb-3",children:e.jsx(j,{md:6,children:e.jsxs(t.Group,{children:[e.jsx(t.Label,{children:"Status"}),e.jsxs(t.Select,{value:a.status,onChange:s=>m("status",s.target.value),children:[e.jsx("option",{value:"PENDING",children:"Tertunda"}),e.jsx("option",{value:"PROCESSING",children:"Proses"}),e.jsx("option",{value:"DONE",children:"Selesai"})]})]})})}),e.jsxs(k,{className:"mb-3",children:[e.jsx(j,{md:6,children:e.jsxs(t.Group,{children:[e.jsx(t.Label,{children:"Start At"}),e.jsx(t.Control,{type:"datetime-local",value:a.startAt,onChange:s=>m("startAt",s.target.value)})]})}),e.jsx(j,{md:6,children:e.jsxs(t.Group,{children:[e.jsx(t.Label,{children:"End At"}),e.jsx(t.Control,{type:"datetime-local",value:a.endAt,onChange:s=>m("endAt",s.target.value)})]})})]}),a.pic.map((s,u)=>e.jsxs(k,{className:"mb-3 align-items-end",children:[e.jsx(j,{md:5,children:e.jsxs(t.Group,{children:[e.jsxs(t.Label,{className:"fw-semibold text-gray-700",children:["Nama PIC ",u+1]}),e.jsx(t.Control,{type:"text",value:s.name,onChange:r=>g(u,"name",r.target.value),placeholder:"Masukkan nama PIC",className:"form-control-solid"})]})}),e.jsx(j,{md:5,children:e.jsxs(t.Group,{children:[e.jsxs(t.Label,{className:"fw-semibold text-gray-700",children:["Qty PIC ",u+1]}),e.jsx(t.Control,{type:"number",value:s.qty,onChange:r=>{const b=r.target.value,i=parseInt(String(a.qtyIn||0),10),h=parseInt(b||"0",10),f=Math.min(Math.max(isNaN(h)?0:h,0),isNaN(i)?0:i);g(u,"qty",f.toString())},min:"0",max:a.qtyIn,placeholder:"0",className:"form-control-solid"})]})}),e.jsx(j,{md:2,className:"text-end",children:e.jsx(q,{variant:"light-danger",size:"sm",className:"btn-icon",onClick:()=>p(u),disabled:a.pic.length===1,children:e.jsx("i",{className:"bi bi-trash3 fs-5"})})})]},u)),e.jsx(k,{className:"mb-3",children:e.jsx(j,{md:6,children:e.jsxs(q,{variant:"outline-primary",onClick:y,children:[e.jsx("i",{className:"bi bi-plus-circle me-2"}),"Tambah PIC"]})})})]})}),e.jsxs(w.Footer,{children:[e.jsx(q,{variant:"secondary",onClick:d,children:"Batal"}),e.jsx(q,{variant:"primary",onClick:o,children:"Simpan"})]})]})},Ce=({show:x,onHide:d,onSubmit:l,initialData:c,history:a})=>{var r,b;const{formData:m,handleFormChange:N,handleNumericChange:y,updateRejectEntry:g,addPicEntry:p,updatePicEntry:v,removePicEntry:o}=ae(c),s=()=>{l(m),d()},u=a||[];return e.jsxs(w,{show:x,onHide:d,size:"lg",children:[e.jsx(w.Header,{closeButton:!0,children:e.jsx(w.Title,{children:"Edit Tahapan Produksi"})}),e.jsxs(w.Body,{children:[e.jsxs(t,{children:[e.jsxs(k,{className:"mb-3",children:[e.jsx(j,{md:8,children:e.jsxs(t.Group,{children:[e.jsx(t.Label,{children:"Nama Tahapan"}),e.jsx(t.Control,{type:"text",value:m.stageName,onChange:i=>N("stageName",i.target.value),placeholder:"Masukkan nama tahapan"})]})}),e.jsx(j,{md:4,children:e.jsxs(t.Group,{children:[e.jsx(t.Label,{children:"Tahap"}),e.jsx(t.Control,{type:"text",value:m.seq,onChange:i=>y("seq",i.target.value),min:"1",placeholder:"1"})]})})]}),e.jsxs(k,{className:"mb-3",children:[e.jsx(j,{md:6,children:e.jsxs(t.Group,{children:[e.jsx(t.Label,{children:"Qty In"}),e.jsx(t.Control,{type:"text",value:m.qtyIn,onChange:i=>{const h=i.target.value,f=parseInt(String((m.qtyMax??m.qtyIn)||0),10),I=parseInt(h||"0",10),L=Math.min(Math.max(isNaN(I)?0:I,0),isNaN(f)?0:f);y("qtyIn",L.toString())},min:"0",max:m.qtyMax??m.qtyIn})]})}),e.jsx(j,{md:6,children:e.jsxs(t.Group,{children:[e.jsx(t.Label,{children:"Status"}),e.jsxs(t.Select,{value:m.status,onChange:i=>N("status",i.target.value),children:[e.jsx("option",{value:"PENDING",children:"Tertunda"}),e.jsx("option",{value:"PROCESSING",children:"Proses"}),e.jsx("option",{value:"DONE",children:"Selesai"})]})]})})]}),e.jsxs(k,{className:"mb-3",children:[e.jsx(j,{md:6,children:e.jsxs(t.Group,{children:[e.jsx(t.Label,{children:"Start At"}),e.jsx(t.Control,{type:"datetime-local",value:m.startAt,onChange:i=>N("startAt",i.target.value)})]})}),e.jsx(j,{md:6,children:e.jsxs(t.Group,{children:[e.jsx(t.Label,{children:"End At"}),e.jsx(t.Control,{type:"datetime-local",value:m.endAt,onChange:i=>N("endAt",i.target.value)})]})})]}),m.pic.map((i,h)=>e.jsxs(k,{className:"mb-3 align-items-end",children:[e.jsx(j,{md:5,children:e.jsxs(t.Group,{children:[e.jsxs(t.Label,{className:"fw-semibold text-gray-700",children:["Nama PIC ",h+1]}),e.jsx(t.Control,{type:"text",value:i.name,onChange:f=>v(h,"name",f.target.value),placeholder:"Masukkan nama PIC",className:"form-control-solid"})]})}),e.jsx(j,{md:5,children:e.jsxs(t.Group,{children:[e.jsxs(t.Label,{className:"fw-semibold text-gray-700",children:["Qty PIC ",h+1]}),e.jsx(t.Control,{type:"number",value:i.qty,onChange:f=>{const I=f.target.value,L=parseInt(String((m.qtyMax??m.qtyIn)||0),10),T=parseInt(I||"0",10),$=Math.min(Math.max(isNaN(T)?0:T,0),isNaN(L)?0:L);v(h,"qty",$.toString())},min:"0",max:m.qtyMax??m.qtyIn,placeholder:"0",className:"form-control-solid"})]})}),e.jsx(j,{md:2,className:"text-end",children:e.jsx(q,{variant:"light-danger",size:"sm",className:"btn-icon btn-active-light-danger",onClick:()=>o(h),disabled:m.pic.length===1,children:e.jsx("i",{className:"bi bi-trash3 fs-5"})})})]},h)),e.jsx(k,{className:"mb-3",children:e.jsx(j,{md:6,children:e.jsxs(q,{variant:"outline-primary",onClick:p,children:[e.jsx("i",{className:"bi bi-plus-circle me-2"}),"Tambah PIC"]})})}),m.stageName==="QC 1"&&e.jsx(e.Fragment,{children:e.jsxs(k,{className:"mb-3 align-items-end",children:[e.jsx(j,{md:6,children:e.jsxs(t.Group,{children:[e.jsx(t.Label,{className:"fw-semibold text-gray-700",children:"Cutting Reject Qty"}),e.jsx(t.Control,{type:"number",value:((r=m.qtyReject[0])==null?void 0:r.qty)||"",onChange:i=>g(0,"qty",i.target.value),min:"0",placeholder:"0",className:"form-control-solid"})]})}),e.jsx(j,{md:6,children:e.jsxs(t.Group,{children:[e.jsx(t.Label,{className:"fw-semibold text-gray-700",children:"Jahit Reject Qty"}),e.jsx(t.Control,{type:"number",value:((b=m.qtyReject[1])==null?void 0:b.qty)||"",onChange:i=>g(1,"qty",i.target.value),min:"0",placeholder:"0",className:"form-control-solid"})]})})]})})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("h5",{children:"Historical Data"}),e.jsxs(be,{striped:!0,bordered:!0,hover:!0,children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Perubahan Data"}),e.jsx("th",{children:"Data Lama"}),e.jsx("th",{children:"Data Baru"}),e.jsx("th",{children:"Created By"}),e.jsx("th",{children:"Created Date"})]})}),e.jsx("tbody",{children:u.map((i,h)=>e.jsxs("tr",{children:[e.jsx("td",{children:i.field_changed}),e.jsx("td",{children:i.old_value??""}),e.jsx("td",{children:i.new_value??""}),e.jsx("td",{children:i.created_by}),e.jsx("td",{children:i.created_dt?new Date(i.created_dt).toLocaleString("id-ID"):""})]},h))})]})]})]}),e.jsxs(w.Footer,{children:[e.jsx(q,{variant:"secondary",onClick:d,children:"Batal"}),e.jsx(q,{variant:"primary",onClick:s,children:"Update"})]})]})},Pe=()=>{const x=Q(),{id:d,spkDetailId:l}=X(),[c,a]=S.useState(!1),[m,N]=S.useState(!1),[y,g]=S.useState({}),[p,v]=S.useState([]),{data:o}=se(d||""),{data:s}=ke(l||""),u=we(),r=qe(),{currentUser:b}=Z(),i=o==null?void 0:o.details.find(n=>n.id===l),h=o,f=s||[],I=()=>{a(!0)},L=n=>{g({stageName:n.stage_name,seq:n.seq,qtyIn:n.qty_in,qtyMax:n.qty_max??n.qty_in,qtyReject:n.stage_name==="QC 1"?[{stageName:"Cutting",qty:n.qty_reject.toString()},{stageName:"Jahit",qty:"0"}]:[],status:n.status,startAt:n.start_at?new Date(n.start_at).toISOString().slice(0,16):"",endAt:n.end_at?new Date(n.end_at).toISOString().slice(0,16):"",pic:n.pics&&n.pics.length>0?n.pics.map(C=>({name:C.pic,qty:C.qty.toString()})):n.pic_id?[{name:n.pic_id,qty:"0"}]:[]}),v(n.history||[]),N(!0)},T=n=>{const C=f.length>0?Math.max(...f.map(P=>P.seq))+1:1,G={spk_detail_id:l||"",stage_name:n.stageName,seq:C,qty_in:n.qtyIn,qty_reject:0,pic:n.pic.map(P=>({pic_id:P.name,qty:parseInt(P.qty||"0",10)})),start_at:n.startAt?new Date(n.startAt).toISOString():"",end_at:n.endAt?new Date(n.endAt).toISOString():"",status:n.status==="PROCESSING"?"PROCESSING":n.status.toUpperCase(),user_id:b==null?void 0:b.full_name};u.mutate(G,{onSuccess:()=>{a(!1)},onError:P=>{console.error("Failed to add stage:",P)}})},$=n=>{var W,z;const C=f.find(E=>E.stage_name===n.stageName||E.seq===n.seq);if(console.log(n),!C){console.error("Stage not found for editing");return}const G=n.stageName==="QC 1"?parseInt(((W=n.qtyReject[0])==null?void 0:W.qty)||"0",10):0,P=n.stageName==="QC 1"?parseInt(((z=n.qtyReject[1])==null?void 0:z.qty)||"0",10):0,te=n.stageName==="QC 1"?G+P:0,le={stage_name:n.stageName,seq:n.seq,qty_in:n.qtyIn,qty_reject:te,qty_reject_cutting:G,qty_reject_sewing:P,pic:n.pic.map(E=>({pic_id:E.name,qty:parseInt(E.qty||"0",10)})),start_at:n.startAt?new Date(n.startAt).toISOString():"",end_at:n.endAt?new Date(n.endAt).toISOString():"",status:n.status,user_id:""};r.mutate({id:C.id,payload:le},{onSuccess:()=>{N(!1)},onError:E=>{console.error("Failed to update stage:",E)}})};return e.jsxs("div",{className:"container-fluid",children:[e.jsx(_,{className:"mb-5",children:e.jsx("div",{className:"card-body",children:e.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"card-title",children:"Detail Tahapan Produksi"}),e.jsx("p",{className:"text-muted",children:i?`${i.product_name} - ${i.color} ${i.size}`:"Produk tidak ditemukan"}),h&&e.jsxs("small",{className:"text-gray-600",children:["SPK: ",h.spk_no," | Buyer: ",h.buyer]})]}),e.jsxs("div",{className:"d-flex gap-2",children:[e.jsx(B,{allowedRoles:["ADMIN","OWNER","ADMIN PRODUKSI"],children:e.jsxs(q,{variant:"dark",className:"btn btn-sm",onClick:I,disabled:!(h!=null&&h.can_add_stage),children:[e.jsx("i",{className:"bi bi-plus-circle me-2"}),"Tambah Tahapan"]})}),e.jsxs("button",{className:"btn btn-sm btn-outline-dark",onClick:()=>x(-1),children:[e.jsx("i",{className:"bi bi-arrow-left me-2"}),"Back to SPK Detail"]})]})]})})}),f.length>0?e.jsx("div",{className:"row",children:f.map((n,C)=>e.jsx("div",{className:"col-lg-4 col-md-6 mb-5",children:e.jsxs(_,{className:"h-100",children:[e.jsx("div",{className:"card-header border-0 pb-0",children:e.jsxs("div",{className:"w-100 d-flex justify-content-between align-items-center pt-4",children:[e.jsxs("div",{children:[e.jsxs("h5",{className:"card-title mb-1",children:[e.jsx("span",{className:"badge badge-circle badge-primary me-2",children:n.seq}),n.stage_name]}),e.jsx("small",{className:"text-muted",children:"Tahapan Produksi"})]}),e.jsxs("div",{className:"d-flex align-items-center gap-2",children:[e.jsx(B,{allowedRoles:["ADMIN","OWNER","ADMIN PRODUKSI"],children:e.jsx(q,{variant:"outline-dark",className:"btn btn-sm",onClick:()=>L(n),disabled:!n.can_edit,title:"Edit Tahapan",children:e.jsx("i",{className:"bi bi-pencil"})})}),e.jsx("span",{className:`badge badge-light-${n.status_badge==="WAITING_APPROVAL"?"warning":n.status_badge} fs-7 fw-bold`,children:n.status==="PROCESSING"?"Proses":n.status==="DONE"?"Selesai":n.status==="PENDING"?"Tertunda":n.status==="DONE_PARTIAL"?"Selesai (Partial)":n.status==="WAITING_APPROVAL"?"Menunggu Persetujuan":n.status})]})]})}),e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"row g-3",children:[e.jsx("div",{className:"col-6",children:e.jsxs("div",{className:"d-flex flex-column",children:[e.jsx("small",{className:"text-muted mb-1",children:"Qty In"}),e.jsx("span",{className:"fw-bold text-gray-900",children:n.qty_in})]})}),e.jsx("div",{className:"col-6",children:e.jsxs("div",{className:"d-flex flex-column",children:[e.jsx("small",{className:"text-muted mb-1",children:"Qty OK"}),e.jsx("span",{className:"fw-bold text-success",children:n.qty_in-n.qty_reject})]})}),e.jsx("div",{className:"col-6",children:e.jsxs("div",{className:"d-flex flex-column",children:[e.jsx("small",{className:"text-muted mb-1",children:"Qty Reject"}),e.jsx("span",{className:"fw-bold text-danger",children:n.qty_reject})]})}),e.jsx("div",{className:"col-6",children:e.jsxs("div",{className:"d-flex flex-column",children:[e.jsx("small",{className:"text-muted mb-1",children:"PIC"}),e.jsx("span",{className:"fw-bold text-gray-900",children:n.pics&&n.pics.length>0?n.pics.map(G=>G.pic).join(", "):n.pic_id||"-"})]})})]}),e.jsx("hr",{className:"my-4"}),e.jsxs("div",{className:"row g-3",children:[e.jsx("div",{className:"col-6",children:e.jsxs("div",{className:"d-flex flex-column",children:[e.jsx("small",{className:"text-muted mb-1",children:"Start At"}),e.jsx("span",{className:"fw-bold text-gray-900",children:n.start_at?new Date(n.start_at).toLocaleString("id-ID"):"-"})]})}),e.jsx("div",{className:"col-6",children:e.jsxs("div",{className:"d-flex flex-column",children:[e.jsx("small",{className:"text-muted mb-1",children:"End At"}),e.jsx("span",{className:"fw-bold text-gray-900",children:n.end_at?new Date(n.end_at).toLocaleString("id-ID"):"-"})]})})]})]})]})},C))}):e.jsx(_,{children:e.jsxs("div",{className:"card-body text-center py-10",children:[e.jsx("div",{className:"mb-4",children:e.jsx("i",{className:"bi bi-info-circle fs-3x text-muted"})}),e.jsx("h4",{className:"text-muted mb-2",children:"Tidak ada tahapan produksi"}),e.jsx("p",{className:"text-muted mb-0",children:"Belum ada data tahapan produksi untuk produk ini."})]})}),e.jsx(_e,{show:c,onHide:()=>a(!1),onSubmit:T,nextSeq:f.length>0?Math.max(...f.map(n=>n.seq))+1:1}),e.jsx(Ce,{show:m,onHide:()=>N(!1),onSubmit:$,initialData:y,history:p})]})},Ae=async x=>{if(!(await M.post("/spk-stage/approval",{id:x.id,status:x.status})).data.success)throw new Error("Failed to approve SPK stage")},Ie=async()=>{const x=await M.get("/spk-stage/waiting-approval?start=0&length=100");if(x.data.success)return x.data.data;throw new Error("Failed to fetch SPK stage waiting approval")},Ee=()=>F({queryKey:["spkStageWaitingApproval"],queryFn:async()=>await Ie()}),De=()=>{const x=V();return U({mutationFn:async d=>await Ae(d),onSuccess:(d,{status:l})=>{x.invalidateQueries({queryKey:["spkStageWaitingApproval"]});const c=l==="APPROVED"?"approved":"rejected";A.success(`SPK stage ${c} successfully`)},onError:d=>{var c;const l=d instanceof J?(c=d.response)==null?void 0:c.data.message:d instanceof Error?d.message:"Failed to process approval";Array.isArray(l)?l.forEach(a=>A.error(a)):A.error(l)}})},Re=()=>{const{data:x,isLoading:d,error:l}=Ee(),c=De();return d?e.jsx("div",{className:"container-fluid",children:e.jsx(_,{children:e.jsx("div",{className:"text-center p-5",children:"Loading approval data..."})})}):l?e.jsx("div",{className:"container-fluid",children:e.jsx(_,{children:e.jsx("div",{className:"text-center p-5 text-danger",children:l.message})})}):e.jsx("div",{className:"container-fluid",children:x&&x.length>0?e.jsx("div",{className:"row",children:x.map(a=>e.jsx("div",{className:"col-lg-6 col-xl-4",children:e.jsxs(_,{className:"h-100",children:[e.jsx("div",{className:"card-header border-0 pb-0",children:e.jsxs("div",{className:"w-100 d-flex justify-content-between align-items-center mt-6",children:[e.jsxs("div",{children:[e.jsxs("h5",{className:"card-title mb-1",children:[e.jsx("span",{className:"badge badge-circle badge-primary me-2",children:a.seq}),a.stage_name]}),e.jsx("small",{className:"text-muted",children:"Stage Production"})]}),e.jsx("span",{className:"badge badge-light-primary fs-7 fw-bold",children:"MENUNGGU PERSETUJUAN"})]})}),e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("h6",{className:"text-gray-800 fw-bold mb-3",children:"SPK Information"}),e.jsxs("div",{className:"row g-2",children:[e.jsxs("div",{className:"col-6",children:[e.jsx("small",{className:"text-muted d-block",children:"SPK No"}),e.jsx("span",{className:"fw-bold text-gray-900",children:a.spk.spk_no})]}),e.jsxs("div",{className:"col-6",children:[e.jsx("small",{className:"text-muted d-block",children:"Buyer"}),e.jsx("span",{className:"fw-bold text-gray-900",children:a.spk.buyer})]}),e.jsxs("div",{className:"col-6",children:[e.jsx("small",{className:"text-muted d-block",children:"Deadline"}),e.jsx("span",{className:"fw-bold text-gray-900",children:R(a.spk.deadline)})]}),e.jsxs("div",{className:"col-6",children:[e.jsx("small",{className:"text-muted d-block",children:"Status"}),e.jsx("span",{className:"badge badge-light-success fs-7",children:a.spk.status})]})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("h6",{className:"text-gray-800 fw-bold mb-3",children:"Product Information"}),e.jsxs("div",{className:"row g-2",children:[e.jsxs("div",{className:"col-12",children:[e.jsx("small",{className:"text-muted d-block",children:"Product Name"}),e.jsx("span",{className:"fw-bold text-gray-900",children:a.product_variant.product_name})]}),e.jsxs("div",{className:"col-6",children:[e.jsx("small",{className:"text-muted d-block",children:"Size"}),e.jsx("span",{className:"fw-bold text-gray-900",children:a.product_variant.size})]}),e.jsxs("div",{className:"col-6",children:[e.jsx("small",{className:"text-muted d-block",children:"Color"}),e.jsx("span",{className:"fw-bold text-gray-900",children:a.product_variant.color})]}),e.jsxs("div",{className:"col-6",children:[e.jsx("small",{className:"text-muted d-block",children:"SKU"}),e.jsx("span",{className:"fw-bold text-gray-900",children:a.product_variant.sku})]})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("h6",{className:"text-gray-800 fw-bold mb-3",children:"Production Details"}),e.jsxs("div",{className:"row g-2",children:[e.jsxs("div",{className:"col-4",children:[e.jsx("small",{className:"text-muted d-block",children:"Qty In"}),e.jsx("span",{className:"fw-bold text-gray-900",children:a.qty_in})]}),e.jsxs("div",{className:"col-4",children:[e.jsx("small",{className:"text-muted d-block",children:"Qty Reject"}),e.jsx("span",{className:"fw-bold text-danger",children:a.qty_reject})]}),e.jsxs("div",{className:"col-4",children:[e.jsx("small",{className:"text-muted d-block",children:"Qty OK"}),e.jsx("span",{className:"fw-bold text-success",children:a.qty_in-a.qty_reject})]}),e.jsxs("div",{className:"col-6",children:[e.jsx("small",{className:"text-muted d-block",children:"PIC"}),e.jsx("span",{className:"fw-bold text-gray-900",children:a.pic_id})]}),e.jsxs("div",{className:"col-6",children:[e.jsx("small",{className:"text-muted d-block",children:"Start At"}),e.jsx("span",{className:"fw-bold text-gray-900",children:a.start_at?new Date(a.start_at).toLocaleString("id-ID"):"-"})]}),e.jsxs("div",{className:"col-12",children:[e.jsx("small",{className:"text-muted d-block",children:"End At"}),e.jsx("span",{className:"fw-bold text-gray-900",children:a.end_at?new Date(a.end_at).toLocaleString("id-ID"):"-"})]})]})]}),e.jsxs("div",{className:"d-flex gap-2",children:[e.jsxs("button",{className:"btn btn-success btn-sm flex-fill",onClick:()=>c.mutate({id:a.id,status:"APPROVED"}),disabled:c.isPending,children:[e.jsx("i",{className:"bi bi-check-circle me-2"}),c.isPending?"Approving...":"Approve"]}),e.jsxs("button",{className:"btn btn-danger btn-sm flex-fill",onClick:()=>c.mutate({id:a.id,status:"REJECTED"}),disabled:c.isPending,children:[e.jsx("i",{className:"bi bi-x-circle me-2"}),c.isPending?"Rejecting...":"Reject"]})]})]})]})},a.id))}):e.jsx(_,{children:e.jsxs("div",{className:"card-body text-center py-10",children:[e.jsx("div",{className:"mb-4",children:e.jsx("i",{className:"bi bi-info-circle fs-3x text-muted"})}),e.jsx("h4",{className:"text-muted mb-2",children:"No Approval Requests"}),e.jsx("p",{className:"text-muted mb-0",children:"There are no SPK stages waiting for approval at the moment."})]})})})},O=[{title:"SPK > ",path:"/spk/",isSeparator:!1,isActive:!1}],Ue=()=>e.jsx(ne,{children:e.jsxs(D,{element:e.jsx(H,{}),children:[e.jsx(D,{path:"list",element:e.jsxs(e.Fragment,{children:[e.jsx(K,{breadcrumbs:O,children:"SPK List"}),e.jsx(ve,{})]})}),e.jsx(D,{path:"stage-approval",element:e.jsxs(e.Fragment,{children:[e.jsx(K,{breadcrumbs:O,children:"SPK Stage Approval"}),e.jsx(Re,{})]})}),e.jsxs(D,{path:"detail/:id",element:e.jsx(H,{}),children:[e.jsx(D,{index:!0,element:e.jsxs(e.Fragment,{children:[e.jsx(K,{breadcrumbs:O,children:"SPK Detail"}),e.jsx(Se,{})]})}),e.jsx(D,{path:"stage/:spkDetailId",element:e.jsxs(e.Fragment,{children:[e.jsx(K,{breadcrumbs:O,children:"SPK Stage Detail"}),e.jsx(Pe,{})]})})]}),e.jsx(D,{index:!0,element:e.jsx(re,{to:"/spk/list"})})]})});export{Ue as default};
